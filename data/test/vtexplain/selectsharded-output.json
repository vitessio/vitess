[
    {
        "SQL": "select * from user /* scatter */",
        "Plans": [
            {
                "Original": "select * from user",
                "Instructions": {
                    "Opcode": "SelectScatter",
                    "Keyspace": {
                        "Name": "ks_sharded",
                        "Sharded": true
                    },
                    "Query": "select * from user",
                    "FieldQuery": "select * from user where 1 != 1"
                }
            }
        ],
        "TabletActions": {
            "ks_sharded/-80": {
                "TabletQueries": [
                    {
                        "SQL": "select * from user /* scatter */",
                        "BindVars": {
                            "#maxLimit": "10001"
                        }
                    }
                ],
                "MysqlQueries": [
                    "select * from user where 1 != 1",
                    "select * from user limit 10001 /* scatter */"
                ]
            },
            "ks_sharded/80-": {
                "TabletQueries": [
                    {
                        "SQL": "select * from user /* scatter */",
                        "BindVars": {
                            "#maxLimit": "10001"
                        }
                    }
                ],
                "MysqlQueries": [
                    "select * from user where 1 != 1",
                    "select * from user limit 10001 /* scatter */"
                ]
            }
        }
    },
    {
        "SQL": "select * from user where id = 1 /* equal unique */",
        "Plans": [
            {
                "Original": "select * from user where id = :vtg1",
                "Instructions": {
                    "Opcode": "SelectEqualUnique",
                    "Keyspace": {
                        "Name": "ks_sharded",
                        "Sharded": true
                    },
                    "Query": "select * from user where id = :vtg1",
                    "FieldQuery": "select * from user where 1 != 1",
                    "Vindex": "hash",
                    "Values": [
                        ":vtg1"
                    ]
                }
            }
        ],
        "TabletActions": {
            "ks_sharded/-80": {
                "TabletQueries": [
                    {
                        "SQL": "select * from user where id = :vtg1 /* equal unique */",
                        "BindVars": {
                            "#maxLimit": "10001",
                            "vtg1": "1"
                        }
                    }
                ],
                "MysqlQueries": [
                    "select * from user where 1 != 1",
                    "select * from user where id = 1 limit 10001 /* equal unique */"
                ]
            }
        }
    },
    {
        "SQL": "select * from user where id > 100 /* scatter range */",
        "Plans": [
            {
                "Original": "select * from user where id > :vtg1",
                "Instructions": {
                    "Opcode": "SelectScatter",
                    "Keyspace": {
                        "Name": "ks_sharded",
                        "Sharded": true
                    },
                    "Query": "select * from user where id > :vtg1",
                    "FieldQuery": "select * from user where 1 != 1"
                }
            }
        ],
        "TabletActions": {
            "ks_sharded/-80": {
                "TabletQueries": [
                    {
                        "SQL": "select * from user where id > :vtg1 /* scatter range */",
                        "BindVars": {
                            "#maxLimit": "10001",
                            "vtg1": "100"
                        }
                    }
                ],
                "MysqlQueries": [
                    "select * from user where 1 != 1",
                    "select * from user where id > 100 limit 10001 /* scatter range */"
                ]
            },
            "ks_sharded/80-": {
                "TabletQueries": [
                    {
                        "SQL": "select * from user where id > :vtg1 /* scatter range */",
                        "BindVars": {
                            "#maxLimit": "10001",
                            "vtg1": "100"
                        }
                    }
                ],
                "MysqlQueries": [
                    "select * from user where 1 != 1",
                    "select * from user where id > 100 limit 10001 /* scatter range */"
                ]
            }
        }
    },
    {
        "SQL": "select * from user where name = 'bob'/* vindex lookup */",
        "Plans": [
            {
                "Original": "select user_id from name_user_map where name = :name",
                "Instructions": {
                    "Opcode": "SelectEqualUnique",
                    "Keyspace": {
                        "Name": "ks_sharded",
                        "Sharded": true
                    },
                    "Query": "select user_id from name_user_map where name = :name",
                    "FieldQuery": "select user_id from name_user_map where 1 != 1",
                    "Vindex": "md5",
                    "Values": [
                        ":name"
                    ]
                }
            },
            {
                "Original": "select * from user where name = :vtg1",
                "Instructions": {
                    "Opcode": "SelectEqualUnique",
                    "Keyspace": {
                        "Name": "ks_sharded",
                        "Sharded": true
                    },
                    "Query": "select * from user where name = :vtg1",
                    "FieldQuery": "select * from user where 1 != 1",
                    "Vindex": "name_user_map",
                    "Values": [
                        ":vtg1"
                    ]
                }
            }
        ],
        "TabletActions": {
            "ks_sharded/-80": {
                "TabletQueries": [
                    {
                        "SQL": "select * from user where name = :vtg1/* vindex lookup */",
                        "BindVars": {
                            "#maxLimit": "10001",
                            "vtg1": "'bob'"
                        }
                    }
                ],
                "MysqlQueries": [
                    "select * from user where 1 != 1",
                    "select * from user where name = 'bob' limit 10001/* vindex lookup */"
                ]
            },
            "ks_sharded/80-": {
                "TabletQueries": [
                    {
                        "SQL": "select user_id from name_user_map where name = :name/* vindex lookup */",
                        "BindVars": {
                            "#maxLimit": "10001",
                            "name": "'bob'"
                        }
                    }
                ],
                "MysqlQueries": [
                    "select user_id from name_user_map where 1 != 1",
                    "select user_id from name_user_map where name = 'bob' limit 10001/* vindex lookup */"
                ]
            }
        }
    },
    {
        "SQL": "select * from user where name = 'bob' or nickname = 'bob'/* vindex lookup */",
        "Plans": [
            {
                "Original": "select * from user where name = :vtg1 or nickname = :vtg1",
                "Instructions": {
                    "Opcode": "SelectScatter",
                    "Keyspace": {
                        "Name": "ks_sharded",
                        "Sharded": true
                    },
                    "Query": "select * from user where (name = :vtg1 or nickname = :vtg1)",
                    "FieldQuery": "select * from user where 1 != 1"
                }
            }
        ],
        "TabletActions": {
            "ks_sharded/-80": {
                "TabletQueries": [
                    {
                        "SQL": "select * from user where (name = :vtg1 or nickname = :vtg1)/* vindex lookup */",
                        "BindVars": {
                            "#maxLimit": "10001",
                            "vtg1": "'bob'"
                        }
                    }
                ],
                "MysqlQueries": [
                    "select * from user where 1 != 1",
                    "select * from user where (name = 'bob' or nickname = 'bob') limit 10001/* vindex lookup */"
                ]
            },
            "ks_sharded/80-": {
                "TabletQueries": [
                    {
                        "SQL": "select * from user where (name = :vtg1 or nickname = :vtg1)/* vindex lookup */",
                        "BindVars": {
                            "#maxLimit": "10001",
                            "vtg1": "'bob'"
                        }
                    }
                ],
                "MysqlQueries": [
                    "select * from user where 1 != 1",
                    "select * from user where (name = 'bob' or nickname = 'bob') limit 10001/* vindex lookup */"
                ]
            }
        }
    },
    {
        "SQL": "select u.id, u.name, u.nickname, n.info from user u join name_info n on u.name = n.name /* join on varchar */",
        "Plans": [
            {
                "Original": "select u.id, u.name, u.nickname, n.info from user as u join name_info as n on u.name = n.name",
                "Instructions": {
                    "Opcode": "Join",
                    "Left": {
                        "Opcode": "SelectScatter",
                        "Keyspace": {
                            "Name": "ks_sharded",
                            "Sharded": true
                        },
                        "Query": "select u.id, u.name, u.nickname from user as u",
                        "FieldQuery": "select u.id, u.name, u.nickname from user as u where 1 != 1"
                    },
                    "Right": {
                        "Opcode": "SelectEqualUnique",
                        "Keyspace": {
                            "Name": "ks_sharded",
                            "Sharded": true
                        },
                        "Query": "select n.info from name_info as n where n.name = :u_name",
                        "FieldQuery": "select n.info from name_info as n where 1 != 1",
                        "Vindex": "md5",
                        "Values": [
                            ":u_name"
                        ],
                        "JoinVars": {
                            "u_name": {}
                        }
                    },
                    "Cols": [
                        -1,
                        -2,
                        -3,
                        1
                    ],
                    "Vars": {
                        "u_name": 1
                    }
                }
            }
        ],
        "TabletActions": {
            "ks_sharded/-80": {
                "TabletQueries": [
                    {
                        "SQL": "select u.id, u.name, u.nickname from user as u /* join on varchar */",
                        "BindVars": {
                            "#maxLimit": "10001"
                        }
                    },
                    {
                        "SQL": "select n.info from name_info as n where n.name = :u_name /* join on varchar */",
                        "BindVars": {
                            "#maxLimit": "10001",
                            "u_name": "'name_val_2'"
                        }
                    },
                    {
                        "SQL": "select n.info from name_info as n where n.name = :u_name /* join on varchar */",
                        "BindVars": {
                            "#maxLimit": "10001",
                            "u_name": "'name_val_2'"
                        }
                    }
                ],
                "MysqlQueries": [
                    "select u.id, u.name, u.nickname from user as u where 1 != 1",
                    "select u.id, u.name, u.nickname from user as u limit 10001 /* join on varchar */",
                    "select n.info from name_info as n where 1 != 1",
                    "select n.info from name_info as n where n.name = 'name_val_2' limit 10001 /* join on varchar */",
                    "select n.info from name_info as n where n.name = 'name_val_2' limit 10001 /* join on varchar */"
                ]
            },
            "ks_sharded/80-": {
                "TabletQueries": [
                    {
                        "SQL": "select u.id, u.name, u.nickname from user as u /* join on varchar */",
                        "BindVars": {
                            "#maxLimit": "10001"
                        }
                    }
                ],
                "MysqlQueries": [
                    "select u.id, u.name, u.nickname from user as u where 1 != 1",
                    "select u.id, u.name, u.nickname from user as u limit 10001 /* join on varchar */"
                ]
            }
        }
    },
    {
        "SQL": "select m.id, m.song, e.extra from music m join music_extra e on m.id = e.id where m.user_id = 100 /* join on int */",
        "Plans": [
            {
                "Original": "select m.id, m.song, e.extra from music as m join music_extra as e on m.id = e.id where m.user_id = :vtg1",
                "Instructions": {
                    "Opcode": "Join",
                    "Left": {
                        "Opcode": "SelectEqualUnique",
                        "Keyspace": {
                            "Name": "ks_sharded",
                            "Sharded": true
                        },
                        "Query": "select m.id, m.song from music as m where m.user_id = :vtg1",
                        "FieldQuery": "select m.id, m.song from music as m where 1 != 1",
                        "Vindex": "hash",
                        "Values": [
                            ":vtg1"
                        ]
                    },
                    "Right": {
                        "Opcode": "SelectEqualUnique",
                        "Keyspace": {
                            "Name": "ks_sharded",
                            "Sharded": true
                        },
                        "Query": "select e.extra from music_extra as e where e.id = :m_id",
                        "FieldQuery": "select e.extra from music_extra as e where 1 != 1",
                        "Vindex": "hash",
                        "Values": [
                            ":m_id"
                        ],
                        "JoinVars": {
                            "m_id": {}
                        }
                    },
                    "Cols": [
                        -1,
                        -2,
                        1
                    ],
                    "Vars": {
                        "m_id": 0
                    }
                }
            }
        ],
        "TabletActions": {
            "ks_sharded/-80": {
                "TabletQueries": [
                    {
                        "SQL": "select e.extra from music_extra as e where e.id = :m_id /* join on int */",
                        "BindVars": {
                            "#maxLimit": "10001",
                            "m_id": "1",
                            "vtg1": "100"
                        }
                    }
                ],
                "MysqlQueries": [
                    "select e.extra from music_extra as e where 1 != 1",
                    "select e.extra from music_extra as e where e.id = 1 limit 10001 /* join on int */"
                ]
            },
            "ks_sharded/80-": {
                "TabletQueries": [
                    {
                        "SQL": "select m.id, m.song from music as m where m.user_id = :vtg1 /* join on int */",
                        "BindVars": {
                            "#maxLimit": "10001",
                            "vtg1": "100"
                        }
                    }
                ],
                "MysqlQueries": [
                    "select m.id, m.song from music as m where 1 != 1",
                    "select m.id, m.song from music as m where m.user_id = 100 limit 10001 /* join on int */"
                ]
            }
        }
    },
    {
        "SQL": "select count(*) from user where id = 1 /* point aggregate */",
        "Plans": [
            {
                "Original": "select count(*) from user where id = :vtg1",
                "Instructions": {
                    "Opcode": "SelectEqualUnique",
                    "Keyspace": {
                        "Name": "ks_sharded",
                        "Sharded": true
                    },
                    "Query": "select count(*) from user where id = :vtg1",
                    "FieldQuery": "select count(*) from user where 1 != 1",
                    "Vindex": "hash",
                    "Values": [
                        ":vtg1"
                    ]
                }
            }
        ],
        "TabletActions": {
            "ks_sharded/-80": {
                "TabletQueries": [
                    {
                        "SQL": "select count(*) from user where id = :vtg1 /* point aggregate */",
                        "BindVars": {
                            "#maxLimit": "10001",
                            "vtg1": "1"
                        }
                    }
                ],
                "MysqlQueries": [
                    "select count(*) from user where 1 != 1",
                    "select count(*) from user where id = 1 limit 10001 /* point aggregate */"
                ]
            }
        }
    },
    {
        "SQL": "select count(*) from user where name in ('alice','bob') /* scatter aggregate */",
        "Plans": [
            {
                "Original": "select user_id from name_user_map where name = :name",
                "Instructions": {
                    "Opcode": "SelectEqualUnique",
                    "Keyspace": {
                        "Name": "ks_sharded",
                        "Sharded": true
                    },
                    "Query": "select user_id from name_user_map where name = :name",
                    "FieldQuery": "select user_id from name_user_map where 1 != 1",
                    "Vindex": "md5",
                    "Values": [
                        ":name"
                    ]
                }
            },
            {
                "Original": "select count(*) from user where name in ::vtg1",
                "Instructions": {
                    "Aggregates": [
                        {
                            "Opcode": "count",
                            "Col": 0
                        }
                    ],
                    "Keys": null,
                    "Input": {
                        "Opcode": "SelectIN",
                        "Keyspace": {
                            "Name": "ks_sharded",
                            "Sharded": true
                        },
                        "Query": "select count(*) from user where name in ::__vals",
                        "FieldQuery": "select count(*) from user where 1 != 1",
                        "Vindex": "name_user_map",
                        "Values": [
                            "::vtg1"
                        ]
                    }
                }
            }
        ],
        "TabletActions": {
            "ks_sharded/-80": {
                "TabletQueries": [
                    {
                        "SQL": "select user_id from name_user_map where name = :name /* scatter aggregate */",
                        "BindVars": {
                            "#maxLimit": "10001",
                            "name": "'alice'"
                        }
                    },
                    {
                        "SQL": "select count(*) from user where name in ::__vals /* scatter aggregate */",
                        "BindVars": {
                            "#maxLimit": "10001",
                            "__vals": "('alice', 'bob')",
                            "vtg1": "('alice', 'bob')"
                        }
                    }
                ],
                "MysqlQueries": [
                    "select user_id from name_user_map where 1 != 1",
                    "select user_id from name_user_map where name = 'alice' limit 10001 /* scatter aggregate */",
                    "select count(*) from user where 1 != 1",
                    "select count(*) from user where name in ('alice', 'bob') limit 10001 /* scatter aggregate */"
                ]
            },
            "ks_sharded/80-": {
                "TabletQueries": [
                    {
                        "SQL": "select user_id from name_user_map where name = :name /* scatter aggregate */",
                        "BindVars": {
                            "#maxLimit": "10001",
                            "name": "'bob'"
                        }
                    }
                ],
                "MysqlQueries": [
                    "select user_id from name_user_map where name = 'bob' limit 10001 /* scatter aggregate */"
                ]
            }
        }
    },
    {
        "SQL": "select name, count(*) from user group by name /* scatter aggregate */",
        "Plans": [
            {
                "Original": "select name, count(*) from user group by name",
                "Instructions": {
                    "Opcode": "SelectScatter",
                    "Keyspace": {
                        "Name": "ks_sharded",
                        "Sharded": true
                    },
                    "Query": "select name, count(*) from user group by name",
                    "FieldQuery": "select name, count(*) from user where 1 != 1 group by name"
                }
            }
        ],
        "TabletActions": {
            "ks_sharded/-80": {
                "TabletQueries": [
                    {
                        "SQL": "select name, count(*) from user group by name /* scatter aggregate */",
                        "BindVars": {
                            "#maxLimit": "10001"
                        }
                    }
                ],
                "MysqlQueries": [
                    "select name, count(*) from user where 1 != 1 group by name",
                    "select name, count(*) from user group by name limit 10001 /* scatter aggregate */"
                ]
            },
            "ks_sharded/80-": {
                "TabletQueries": [
                    {
                        "SQL": "select name, count(*) from user group by name /* scatter aggregate */",
                        "BindVars": {
                            "#maxLimit": "10001"
                        }
                    }
                ],
                "MysqlQueries": [
                    "select name, count(*) from user where 1 != 1 group by name",
                    "select name, count(*) from user group by name limit 10001 /* scatter aggregate */"
                ]
            }
        }
    },
    {
        "SQL": "select 1, \"hello\", 3.14 from user limit 10 /* select constant sql values */",
        "Plans": [
            {
                "Original": "select :vtg1, :vtg2, :vtg3 from user limit :vtg4",
                "Instructions": {
                    "Opcode": "Limit",
                    "Count": ":vtg4",
                    "Input": {
                        "Opcode": "SelectScatter",
                        "Keyspace": {
                            "Name": "ks_sharded",
                            "Sharded": true
                        },
                        "Query": "select :vtg1, :vtg2, :vtg3 from user limit :vtg4",
                        "FieldQuery": "select :vtg1, :vtg2, :vtg3 from user where 1 != 1"
                    }
                }
            }
        ],
        "TabletActions": {
            "ks_sharded/-80": {
                "TabletQueries": [
                    {
                        "SQL": "select :vtg1, :vtg2, :vtg3 from user limit :vtg4 /* select constant sql values */",
                        "BindVars": {
                            "#maxLimit": "10001",
                            "vtg1": "1",
                            "vtg2": "'hello'",
                            "vtg3": "3.14",
                            "vtg4": "10"
                        }
                    }
                ],
                "MysqlQueries": [
                    "select 1, 'hello', 3.14 from user limit 10 /* select constant sql values */"
                ]
            },
            "ks_sharded/80-": {
                "TabletQueries": [
                    {
                        "SQL": "select :vtg1, :vtg2, :vtg3 from user limit :vtg4 /* select constant sql values */",
                        "BindVars": {
                            "#maxLimit": "10001",
                            "vtg1": "1",
                            "vtg2": "'hello'",
                            "vtg3": "3.14",
                            "vtg4": "10"
                        }
                    }
                ],
                "MysqlQueries": [
                    "select 1, 'hello', 3.14 from user limit 10 /* select constant sql values */"
                ]
            }
        }
    },
    {
        "SQL": "select * from (select id from user) s /* scatter paren select */",
        "Plans": [
            {
                "Original": "select * from (select id from user) as s",
                "Instructions": {
                    "Opcode": "SelectScatter",
                    "Keyspace": {
                        "Name": "ks_sharded",
                        "Sharded": true
                    },
                    "Query": "select * from (select id from user) as s",
                    "FieldQuery": "select * from (select id from user where 1 != 1) as s where 1 != 1"
                }
            }
        ],
        "TabletActions": {
            "ks_sharded/-80": {
                "TabletQueries": [
                    {
                        "SQL": "select * from (select id from user) as s /* scatter paren select */",
                        "BindVars": {
                            "#maxLimit": "10001"
                        }
                    }
                ],
                "MysqlQueries": [
                    "select * from (select id from user where 1 != 1) as s where 1 != 1",
                    "select * from (select id from user) as s limit 10001 /* scatter paren select */"
                ]
            },
            "ks_sharded/80-": {
                "TabletQueries": [
                    {
                        "SQL": "select * from (select id from user) as s /* scatter paren select */",
                        "BindVars": {
                            "#maxLimit": "10001"
                        }
                    }
                ],
                "MysqlQueries": [
                    "select * from (select id from user where 1 != 1) as s where 1 != 1",
                    "select * from (select id from user) as s limit 10001 /* scatter paren select */"
                ]
            }
        }
    }
]
